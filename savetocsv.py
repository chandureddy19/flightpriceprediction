import csv
import requests


url = "https://apis.paycor.com/v1/legalentities/159994/payrollProcessing?subscription-key=cf71348e948b45059ebd6b353083d650&fromCheckDate=2025-06-20"

headers = {
    'Ocp-Apim-Subscription-Key': 'cf71348e948b45059ebd6b353083d650',
  'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImYxZjI5Y2QxNmFmMzk0YzFjNWY1MzJhYzkyNTMzOTNjIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwczovL2FwaS5wYXljb3IuY29tL3N0cy92Mi9jb21tb24iLCJleHAiOjE3NTA3NzkyMzAsImlhdCI6MTc1MDc3NzQzMCwibmJmIjoxNzUwNzczODMwLCJjbGllbnRfaWQiOiIzMTQ2ZTAxYTAwNmM4YTAwNTViYSIsInNrZXkiOiJmNDAyMjZjZi0wMjE5LTQ3ODctOTYwYS1hNTk1MzdlMTQ5NzMiLCJzaWQiOiJmNDAyMjZjZi0wMjE5LTQ3ODctOTYwYS1hNTk1MzdlMTQ5NzMiLCJhdXRoX3RpbWUiOjE3MjczNzIwNDcsInZlciI6MSwic3ViIjoiYzcxOTU0OWQtOGI0Ny00ODBlLTk4YjctYTk4YmNlNDMzZDAwIiwiaWRwIjozLCJwYXljb3JfdXNlcmlkZW50aXR5IjoiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIiwicGF5Y29yX3RpbWVvdXQiOjIwLCJwYXljb3JfYnYiOiJYSUFfbzAwZUMwU1Fuems2V3JpR1R3IiwicGF5Y29yX3ByaXZpbGVnZXMiOiJINHNJQUFBQUFBQUFDbDJUTzVMak1BeEU3K0tZQWZIalp6UFgxc1N6K2RhY3hPVzd6MnNwa1J5SVlCTmdFMmhBcjhmeitmZng1Ny9WM2p2YlllbzA0elN6MmZSbDZ6RGVUMk9uOGRQa1Q0UG1HNXBqODA5OG5aQWVmTHVaY2N2QXhnTUdyY0VwQ3QxM3pweXpBQ2M0OVN6eEJSN1puSGduM20wM0p6WklKQW83Wjh0ZWZLc2wvQWwzNGt2aWtpd1Qvb1EvUFZvbVp4UGYxcmRia1ZOeHB5eGFwYldxMVdyTk5tSzNRUTVqN2piSlo1YTNGYU90aWVWc2NYZjMzblpGTytUcGcwTDZRSm8rVlJxNTJGR1F3VVMxS2xXMVdCMUZhemNsdzBRWG93Q3pwZDFTc0ZRM2lXMWthUzc1blB4WWNFZ0Zsa00yZVNrUzhlRHpVMGJwU0tFc0NuR0Z1RUpDSVZMV1F5R2hrSkRnSVZMSjdha3pCS0FKMmcwNXRod2JHSjFkcUlXaERFSjNReVhFSkM2V3ZPdlk0WlhrTEZCbGFCRnpEclZVM2xJdXBWeEtMSldDQ2ltNll5VTFwdVpnS3F1cDdrOWRtMHVEcDRTV1NsaDZja243SmEzb0NCUEgvTDdlR05rSEE4ZjRlZmM5T2o3bTdnN3pEc2NWTW1CWHlLemQ0SnhYeVBSZElVTjBoY3pNL2FFN3RYcjdnVzlzNnVrSC9vajNXekpxK2gyUEN4L2lmUEZUdnQ3dlgyYm90Zkx2QXdBQSIsInBheWNvcl96aXAiOlsicGF5Y29yX3ByaXZpbGVnZXMiLCJwYXljb3JfY2xpZW50cyJdLCJuYW1lIjoiQmVuc29uIEF1dG9tb3RpdmUgSW50ZWdyYXRpb24iLCJnaXZlbl9uYW1lIjoiQmVuc29uIEF1dG9tb3RpdmUiLCJmYW1pbHlfbmFtZSI6IkludGVncmF0aW9uIiwiZW1haWwiOiJJVC1JbnRlZ3JhdGlvbnNTdXBwb3J0RExAcGF5Y29yLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJwYXljb3JfY2xpZW50cyI6Ikg0c0lBQUFBQUFBQUNxdFdjbGF5aXE1V2NzN0pUTTByOFV4UnNqSTB0YlMwTk5GUmNzN1BMVWpNcXdRSkdSa1lXWm9aNkNpNTVoYms1RmVtcG9abUFnWHpTbk55UUtyeVNoS1RTNUJGQ2hMUkJXdDFNQ3d3cDdVRnByUzJ3SXlXRnBnYldSaGEwTmdDSTZCcHRMWEFrTllXR05IYUFpcm5nOWhhQUh1dW8zaHdBd0FBIiwiaXBhZGRyIjoiNDkuMjA0LjIxMi4yMTgiLCJqdGkiOiJlMGIxNjk5Y2E0YTVjZTk5NjQ5MzAyMWI4YWQ1ZTlhYiIsInNjb3BlIjpbIjFlYjRjMWY3OGY3YWVmMTFiZGZiMDAyMjQ4OTEzYzVkIiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhdWQiOiIzMTQ2ZTAxYTAwNmM4YTAwNTViYSJ9.FTv_O-4zCuRn_JJlgBzcceRxafob27J3Ooidc5xee0u3v50zxY3Sx7VrgcMpdvsIIg6DaZFRJTVlU2NqDaLqkCw56fZMIoCuCl78joeE24w3v6Np298ApohGGVjsq23vGaWu8tqE4Q-mO-F2ZLM8SpC7c2-SN_xNFZZQ5nDCiKF247puv7H0Ru8x4Skh3Wrzt-3GRlZQ3JIcYxaBIPUZqEFZ9d7VSmAXzaE2KRf7oDlA3Y6Puz6d3yu4ziwT92rXPn5on8mvprERCxsn3_5e9U4o9bOPVwnDeWVCk4Pg9cYEXBpI4NKbCDTZ-EBJoSwR5j_7I9W3BE69aNz-9dFuSw'
}

response = requests.get(url, headers=headers)


if response.status_code == 200:

    data = response.json()

    records = data.get("records", [])
    filename = "all_planner_records_Mercedes Benz of New Orleans.csv"
    
    if records:
        with open(filename, mode='w', newline='') as file:
            writer = csv.DictWriter(file, fieldnames=records[0].keys())
            writer.writeheader()
            writer.writerows(records)

        print(f"Saved {len(records)} records to {filename}")
    else:
        print("No records found.")
else:
    print(f"Failed to fetch data. HTTP Status code: {response.status_code} and {response.text}")
